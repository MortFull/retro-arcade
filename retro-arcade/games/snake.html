<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Snake</title>
  <link rel="stylesheet" href="../css/style.css">
</head>
<body>
  <!-- Back button with sound -->
  <button id="backBtn" onclick="playSound('back'); window.location.href='../index.html'">â¬… Back to Arcade</button>

  <div id="overlay">
    <div class="game-message" id="gameMessage">GAME OVER</div>
    <div class="restart-message">Press Enter to Restart</div>
  </div>

  <canvas id="snake" width="400" height="400"></canvas>

<script src="../js/sound.js"></script>
<script>
const canvas = document.getElementById("snake");
const ctx = canvas.getContext("2d");
const overlay = document.getElementById("overlay");
const gameMessage = document.getElementById("gameMessage");

let snake, food, dx, dy, gameOver, game;

function initGame(){
  snake = [{x:200,y:200}];
  food = {x: Math.floor(Math.random()*20)*20, y: Math.floor(Math.random()*20)*20};
  dx = 20; dy = 0;
  gameOver = false;
  overlay.style.display = "none";
  clearInterval(game);
  game = setInterval(draw,100);
}

document.addEventListener("keydown", e=>{
  if(e.key==="ArrowUp" && dy===0){ dx=0; dy=-20; }
  if(e.key==="ArrowDown" && dy===0){ dx=0; dy=20; }
  if(e.key==="ArrowLeft" && dx===0){ dx=-20; dy=0; }
  if(e.key==="ArrowRight" && dx===0){ dx=20; dy=0; }
  if(e.key==="Enter" && gameOver){ initGame(); }
});

function draw(){
  ctx.fillStyle="black";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // draw snake
  ctx.fillStyle="#0f0";
  for(let s of snake){
    ctx.fillRect(s.x,s.y,20,20);
  }

  // move snake
  let head = {x: snake[0].x+dx, y: snake[0].y+dy};
  snake.unshift(head);

  // eat food
  if(head.x===food.x && head.y===food.y){
    food = {x: Math.floor(Math.random()*20)*20, y: Math.floor(Math.random()*20)*20};
    playSound("snake-eat"); // eating sound
  } else {
    snake.pop();
  }

  // draw food
  ctx.fillStyle="#ff0";
  ctx.fillRect(food.x,food.y,20,20);

  // collision with walls
  if(head.x<0 || head.x>=canvas.width || head.y<0 || head.y>=canvas.height){
    endGame("GAME OVER");
  }

  // collision with self
  for(let i=1;i<snake.length;i++){
    if(head.x===snake[i].x && head.y===snake[i].y){
      endGame("GAME OVER");
    }
  }
}

function endGame(message){
  clearInterval(game);
  gameOver=true;
  overlay.style.display = "flex";
  gameMessage.textContent = message;
  playSound("game-over"); // game over sound
}

initGame();
</script>
</body>
</html>